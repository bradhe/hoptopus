<% if include_form %>
<%= form_tag (url) %>
<% end %>

<div class="clearfix">
    <ul class="errors"></ul>
  
    <div class="add-beer left">
        <div class="field">
            <%= label_tag "#{form_element_prefix}[brewery_id]", "Beer:" %>

            <% unless beer.brew.nil? %>
                <span class="value"><%= beer.brewery_name %></span>
            <% else %>
                <%= select_tag "#{form_element_prefix}[brewery_id]", options_from_collection_for_select(Brewery.order("name").all, "id", "name"), { :include_blank => "Brewery" } %>
            <% end %>
        </div>

        <div class="field">
            <%= label_tag "#{form_element_prefix}[year]", "Year:" %>
            <%= text_field_tag "#{form_element_prefix}[year]", beer.year %>
        </div>

        <div class="field">
            <%= label_tag "#{form_element_prefix}[abv]", "ABV:" %>
            <%= text_field_tag "#{form_element_prefix}[abv]", beer.abv %> %
        </div>

        <div class="field">
            <%= label_tag "#{form_element_prefix}[bottle_size_id]", "Bottle Size:" %>
            <%= select_tag "#{form_element_prefix}[bottle_size_id]", options_from_collection_for_select(BottleSize.order("sort_order").all, :id, :name, beer.bottle_size) %>
        </div>

        <div class="field">
            <%= label_tag "#{form_element_prefix}[price]", "Price:" %>
            $ <%= text_field_tag "#{form_element_prefix}[price]", beer.price %>
        </div>
    </div>

    <div class="add-beer left">
        <div class="field">
            <% unless beer.brew.nil? %>
              <span class="value"><%= beer.name %></span>
            <% else %>
              <%= select_tag "#{form_element_prefix}[brew_id]", nil, { :include_blank => "Beer", :disabled => true } %>
            <% end %>
        </div>

        <div class="field">
            <%= label_tag "#{form_element_prefix}[quantity]", "Quantity:" %>
            <%= text_field_tag "#{form_element_prefix}[quantity]", beer.quantity %>
        </div>
		
        <div class="field">
            <%= label_tag "#{form_element_prefix}[cellared_at]", "Cellared Date:" %>
            <%= text_field_tag "#{form_element_prefix}[cellared_at]", beer.cellared_at ? beer.cellared_at.strftime("%Y-%m-%d") : nil, :class => "date cellared_at" %>
        </div>

        <div class="field">
            <%= label_tag "#{form_element_prefix}[finish_aging_at]", "Age For:" %>
          
            <%= select_tag "beer_finish_aging_year", options_for_select((0..50).to_a, ((beer.finish_aging_at.year - beer.cellared_at.year) unless beer.finish_aging_at.nil?)), :class => 'finish_aging_year' %> years
            <%= select_tag "beer_finish_aging_month", options_for_select((0..11).to_a, ((beer.finish_aging_at.month - beer.cellared_at.month) unless beer.finish_aging_at.nil?)), :class => 'finish_aging_month' %> months

            <div class="sub field">
              <%= text_field_tag "#{form_element_prefix}[finish_aging_at]", beer.finish_aging_at ? beer.finish_aging_at.strftime("%Y-%m-%d") : nil, :class => "date finish_aging_at" %>
            </div>
        </div>
    </div>
	
	<% if beer.tasting_notes.empty? %>
	<h3>Initial Tasting Notes</h3>
	<% else %>
	<h3>Tasting Notes</h3>
	<% end %>
	
	<%= form_for(beer.tasting_notes.new, beer) do |f| %>
	<div class="new-tasting-note left">
		<div class="field">
			<%= f.label :appearance_rating, 'Appearance:' %>
			<%= f.text_box :appearance_rating %>
	</div>
	
	<div class="new-tasting-note left">
		
	</div>
	<% end %>
</div>

<% if include_buttons %>
<div class="buttons submit">
    <button type="button" data-close-dialog>Cancel</button>
    <button type="submit">Add Beer to Cellar</button>
</div>
<% end %>

<% if include_form %>
</form>
<% end %>